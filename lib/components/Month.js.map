{"version":3,"file":"Month.js","sourceRoot":"","sources":["../../src/components/Month.ts"],"names":[],"mappings":"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","sourcesContent":["import {LitElement, css, html} from 'lit';\nimport {customElement, property} from 'lit/decorators.js';\nimport getDateByMonthInDirection from '../utils/getDateByMonthInDirection';\n\n@customElement('lms-calendar-month')\nexport default class Month extends LitElement {\n  @property({attribute: false})\n  activeDate?: CalendarDate;\n\n  static override styles = css`\n    .month {\n      /* Header: 3.5em, Context: 2em, Border: 2px */\n      height: calc(100% - 5.5em + 2px);\n      display: grid;\n      grid-template-columns: repeat(7, 1fr);\n      border-top: 1px solid var(--separator-light);\n    }\n\n    .month > div {\n      border-bottom: 1px solid var(--separator-light);\n      border-right: 1px solid var(--separator-light);\n    }\n\n    .month > div:nth-child(7n + 7) {\n      border-right: none;\n    }\n\n    .month > div:nth-last-child(-n + 7) {\n      border-bottom: none;\n    }\n\n    .day {\n      width: 100%;\n      position: relative;\n      display: flex;\n      flex-direction: column;\n      overflow-y: scroll;\n      gap: 1px;\n    }\n\n    .indicator {\n      position: sticky;\n      top: 0.25em;\n      text-align: right;\n      padding: 0 0.25em;\n      text-align: left;\n    }\n  `;\n\n  override render() {\n    return Object.keys(this.activeDate || {day: 1, month: 1, year: 2022})\n      .length !== 0\n      ? html`\n          <div class=\"month\">\n            ${this._getCalendarArray()?.map(\n              ({year, month, day}) =>\n                html`<div\n                  class=\"day\"\n                  data-date=\"${year}-${month}-${day}\"\n                  @click=${this._handleExpand}\n                >\n                  <div class=\"indicator\">\n                    ${day === 1 ? `${day}. ${month}` : day}\n                  </div>\n                  <slot name=\"${year}-${month}-${day}\"></slot>\n                </div>`\n            )}\n          </div>\n        `\n      : html``;\n  }\n\n  _handleExpand(e: Event) {\n    if (e.target === null) {\n      return;\n    }\n\n    const target = e.target as HTMLElement;\n    const {date} = target.dataset;\n\n    if (!date) {\n      return;\n    }\n\n    const [year, month, day] = date\n      .split('-')\n      .map((field: string) => parseInt(field, 10));\n    const event = new CustomEvent('expand', {\n      detail: {date: {day, month, year}},\n      bubbles: true,\n      composed: true,\n    });\n    this.dispatchEvent(event);\n  }\n\n  _getDaysInMonth(date: CalendarDate) {\n    /** Important note: Passing 0 as the date shifts the\n     *  months indices by positive 1, so 1-12 */\n    return new Date(date.year, date.month, 0).getDate();\n  }\n\n  _getOffsetOfFirstDayInMonth(date: CalendarDate) {\n    const offset = new Date(`${date.year}-${date.month}-01`).getDay() - 1;\n    return offset === -1 ? 6 : offset;\n  }\n\n  _getDatesInMonthAsArray(date: CalendarDate, sliceArgs: number[]) {\n    return [\n      ...Array.from(Array(this._getDaysInMonth(date)).keys(), (_, n) => ({\n        year: date.year,\n        month: date.month,\n        day: n + 1,\n      })).slice(...sliceArgs),\n    ];\n  }\n\n  _getCalendarArray() {\n    if (!this.activeDate) {\n      return;\n    }\n\n    const previousMonth = this._getDatesInMonthAsArray(\n      getDateByMonthInDirection(this.activeDate, 'previous'),\n      this._getOffsetOfFirstDayInMonth(this.activeDate)\n        ? [this._getOffsetOfFirstDayInMonth(this.activeDate) * -1]\n        : [-0, -0]\n    );\n    const activeMonth = this._getDatesInMonthAsArray(this.activeDate, []);\n    const nextMonth = this._getDatesInMonthAsArray(\n      getDateByMonthInDirection(this.activeDate, 'next'),\n      [0, 42 - (previousMonth.length + activeMonth.length)]\n    );\n\n    return previousMonth.concat(activeMonth, nextMonth);\n  }\n}"]}