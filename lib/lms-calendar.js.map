{"version":3,"file":"lms-calendar.js","sourceRoot":"","sources":["../src/lms-calendar.ts"],"names":[],"mappings":"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","sourcesContent":["import {LitElement, css, html, nothing} from 'lit';\nimport {customElement, property, state} from 'lit/decorators.js';\n\nimport './components/Header.js';\nimport LMSCalendarHeader from './components/Header';\nimport './components/Month.js';\nimport LMSCalendarMonth from './components/Month';\nimport './components/Day.js';\nimport LMSCalendarDay from './components/Day';\nimport './components/Context.js';\nimport LMSCalendarContext from './components/Context';\nimport './components/Entry.js';\nimport LMSCalendarEntry from './components/Entry';\nimport isEmptyObjectOrUndefined from './utils/isEmptyObjectOrUndefined.js';\nimport getColorTextWithContrast from './utils/getColorTextWithContrast.js';\nimport partitionOverlappingIntervals from './utils/partitionOverlappingIntervals.js';\nimport getOverlappingEntitiesIndices from './utils/getOverlappingEntitiesIndices.js';\nimport haveSameValues from './utils/haveSameValues.js';\nimport getSortedGradingsByIndex from './utils/getSortedGradingsByIndex.js';\nimport EntryTransformer from './lib/EntryTransformer.js';\nimport DateTransformer from './lib/DateTransformer.js';\n\n@customElement('lms-calendar')\nexport default class LMSCalendar extends LitElement {\n  @property({type: String})\n  heading = '';\n\n  @property({type: Object})\n  activeDate: CalendarDate = {\n    day: 1,\n    month: 1,\n    year: 2022,\n  };\n\n  @property({type: Array})\n  entries: CalendarEntry[] = [];\n\n  @property({type: String})\n  color = '#000000';\n\n  @state()\n  _expandedDate?: CalendarDate;\n\n  @state() _viewportWidth: number = window.innerWidth;\n\n  static override styles = css`\n    :host {\n      --shadow-sm: rgba(0, 0, 0, 0.18) 0px 2px 4px;\n      --shadow-md: rgba(0, 0, 0, 0.15) 0px 3px 3px 0px;\n      --shadow-lg: rgba(0, 0, 0, 0.15) 0px 2px 8px;\n      --shadow-hv: rgba(0, 0, 0, 0.08) 0px 4px 12px;\n\n      --breakpoint-xs: 425px;\n      --breakpoint-sm: 768px;\n      --breakpoint-md: 1024px;\n\n      --separator-light: rgba(0, 0, 0, 0.1);\n      --separator-mid: rgba(0, 0, 0, 0.4);\n      --separator-dark: rgba(0, 0, 0, 0.7);\n\n      --system-ui: system, -apple-system, '.SFNSText-Regular', 'San Francisco',\n        'Roboto', 'Segoe UI', 'Helvetica Neue', 'Lucida Grande', sans-serif;\n\n      --border-radius-sm: 5px;\n      --border-radius-md: 7px;\n      --border-radius-lg: 12px;\n    }\n    div {\n      height: 100%;\n      width: 100%;\n      background-color: #fff;\n      border-radius: var(--border-radius-lg);\n      border: 1px solid var(--separator-light);\n      font-family: var(--system-ui);\n      color: var(--separator-dark);\n      box-shadow: var(--shadow-md);\n    }\n  `;\n\n  override render() {\n    return html`\n      <div>\n        <lms-calendar-header\n          @switchdate=${this._handleSwitchDate}\n          @switchview=${this._handleSwitchView}\n          .heading=${this.heading}\n          .activeDate=${this.activeDate}\n          .expandedDate=${this._expandedDate}\n        >\n        </lms-calendar-header>\n\n        <lms-calendar-context\n          ?hidden=${!isEmptyObjectOrUndefined(this._expandedDate)}\n        >\n        </lms-calendar-context>\n\n        <lms-calendar-month\n          @expand=${this._handleExpand}\n          .activeDate=${this.activeDate}\n          ?hidden=${!isEmptyObjectOrUndefined(this._expandedDate)}\n        >\n          ${this._getEntries()}\n        </lms-calendar-month>\n\n        <lms-calendar-day\n          ?hidden=${isEmptyObjectOrUndefined(this._expandedDate)}\n        >\n          ${this._getEntriesByDate()}\n        </lms-calendar-day>\n      </div>\n    `;\n  }\n\n  _handleSwitchDate(e: CustomEvent) {\n    const dateTransformer = new DateTransformer({});\n    dateTransformer._direction = e.detail.direction;\n\n    if (this._expandedDate) {\n      dateTransformer._date = this._expandedDate;\n      const dateInDirection = dateTransformer.getDateByDayInDirection();\n      this._expandedDate = dateInDirection;\n      this.activeDate = dateInDirection;\n      return;\n    }\n\n    dateTransformer._date = this.activeDate;\n    this.activeDate = dateTransformer.getDateByMonthInDirection();\n  }\n\n  _handleSwitchView(e: CustomEvent) {\n    if (e.detail.view === 'day') {\n      this._expandedDate = !isEmptyObjectOrUndefined(this._expandedDate)\n        ? this._expandedDate\n        : this.activeDate;\n    }\n\n    if (e.detail.view === 'month') {\n      this.activeDate = this._expandedDate ?? this.activeDate;\n      this._expandedDate = undefined;\n    }\n  }\n\n  _handleExpand(e: CustomEvent) {\n    this._expandedDate = e.detail.date;\n  }\n\n  _getEntries() {\n    if (this.entries.length) {\n      const chronologicalEntries = this.entries.sort(\n        (a, b) =>\n          a.time.start.hours - b.time.start.hours ||\n          a.time.start.minutes - b.time.start.minutes\n      );\n\n      const entriesTemplateResults = chronologicalEntries.map(\n        ({date, time, heading, color}, index) => {\n          const [background, text] = getColorTextWithContrast(color);\n          const [startDate, , rangeDays] = this._getDaysRange(date);\n\n          /** Create an array of <lms-calendar-entry> elements for each day the entry spans\n           *  and add them to the entries array. */\n          const entries = [];\n          for (let i = 0; i < rangeDays; i++) {\n            const currentEntry = new EntryTransformer(\n              {date, time, heading, color, content: ''},\n              startDate,\n              i\n            ).getEntry();\n\n            const isContinuation = i > 0 && rangeDays > 1;\n            const lmsCalendarEntry = html`\n              <style>\n                lms-calendar-entry.${`_${index}`} {\n                  --entry-br: ${rangeDays > 1 ? 0 : `var(--border-radius-sm)`};\n                  --entry-m: 0 ${i !== 0 ? 0 : `0.25em`} 0\n                    ${i !== 0 ? 0 : `1.5em`};\n                  --entry-bc: ${background};\n                  --entry-c: ${text};\n                }\n              </style>\n              <lms-calendar-entry\n                class=${`_${index}`}\n                slot=\"${currentEntry.date.start.year}-${currentEntry.date.start\n                  .month}-${currentEntry.date.start.day}\"\n                .time=${currentEntry.time}\n                .heading=${isContinuation ? '' : currentEntry.heading}\n                .isContinuation=${isContinuation}\n              >\n              </lms-calendar-entry>\n            `;\n            entries.push(lmsCalendarEntry);\n          }\n\n          return entries;\n        }\n      );\n\n      return entriesTemplateResults.flat();\n    }\n\n    return nothing;\n  }\n\n  _getEntriesByDate() {\n    if (isEmptyObjectOrUndefined(this._expandedDate)) {\n      return;\n    }\n    const entriesByDate = this.entries.filter((entry) => {\n      return haveSameValues(entry.date.start, this._expandedDate || {});\n    });\n\n    const grading = getSortedGradingsByIndex(\n      !isEmptyObjectOrUndefined(entriesByDate)\n        ? getOverlappingEntitiesIndices(\n            this._getPartitionedSlottedItems(entriesByDate)\n          )\n        : []\n    );\n\n    return entriesByDate.map(({time, heading, content, color}, index) => {\n      const [background, text] = getColorTextWithContrast(color);\n      return html`\n        <style>\n          lms-calendar-entry.${`_${index}`} {\n            --start-slot: ${this._getGridSlotByTime(time)};\n            --entry-w: ${this._getWidthByGroupSize({grading, index})}%;\n            --entry-m: 0 1.5em 0 ${this._getOffsetByDepth({grading, index})}%;\n            --entry-bc: ${background};\n            --entry-c: ${text};\n          }\n        </style>\n        <lms-calendar-entry\n          class=${`_${index}`}\n          slot=${time.start.hours}\n          .time=${time}\n          .heading=${heading}\n          .content=${content}\n        >\n        </lms-calendar-entry>\n      `;\n    });\n  }\n\n  _getGridSlotByTime({start, end}: CalendarTimeInterval) {\n    const startRow = start.hours * 60 + (start.minutes + 1);\n    return `${startRow}/${\n      startRow + (end.hours * 60 + end.minutes - startRow)\n    }`;\n  }\n\n  _getWidthByGroupSize({grading, index}: {grading: Grading[]; index: number}) {\n    /** We have to return a default if there are no groups defined on the items */\n    if (!grading.length) {\n      return 100;\n    }\n\n    return (\n      100 / grading.filter((item) => item.group === grading[index].group).length\n    );\n  }\n\n  _getOffsetByDepth({grading, index}: {grading: Grading[]; index: number}) {\n    /** We have to return a default if there are no groups defined on the items */\n    if (!grading.length) {\n      return 0;\n    }\n\n    return grading[index].depth === 0\n      ? 0\n      : grading[index].depth *\n          (100 /\n            grading.filter((item) => item.group === grading[index].group)\n              .length);\n  }\n\n  _getPartitionedSlottedItems(items: CalendarEntry[]) {\n    return partitionOverlappingIntervals(\n      items\n        .map((entry: CalendarEntry) =>\n          this._getGridSlotByTime(entry.time)\n            .replace(/[^0-9/]+/g, '')\n            .split('/')\n        )\n        .map(([start, end]) => [parseInt(start, 10), parseInt(end, 10)])\n        .map(([start, end]) => ({start, end}))\n    );\n  }\n\n  _getDaysRange(date: CalendarDateInterval): [Date, Date, number] {\n    const {start, end} = date;\n    const startDate = new Date(start.year, start.month - 1, start.day);\n    const endDate = new Date(end.year, end.month - 1, end.day);\n\n    return [\n      startDate,\n      endDate,\n      (endDate.getTime() - startDate.getTime()) / (1000 * 3600 * 24) + 1,\n    ];\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    'lms-calendar': LMSCalendar;\n    'lms-calendar-header': LMSCalendarHeader;\n    'lms-calendar-month': LMSCalendarMonth;\n    'lms-calendar-day': LMSCalendarDay;\n    'lms-calendar-context': LMSCalendarContext;\n    'lms-calendar-entry': LMSCalendarEntry;\n  }\n\n  interface CalendarDate {\n    day: number;\n    month: number;\n    year: number;\n  }\n\n  interface CalendarDateInterval {\n    start: CalendarDate;\n    end: CalendarDate;\n  }\n\n  interface CalendarTime {\n    hours: number;\n    minutes: number;\n  }\n\n  interface CalendarTimeInterval {\n    start: CalendarTime;\n    end: CalendarTime;\n  }\n\n  interface CalendarEntry {\n    date: CalendarDateInterval;\n    time: CalendarTimeInterval;\n    heading: string;\n    content: string;\n    color: string;\n  }\n\n  interface Interval {\n    start: number;\n    end: number;\n  }\n\n  interface Grading {\n    index: number;\n    depth: number;\n    group: number;\n  }\n\n  interface Partition {\n    index: number | undefined;\n    depth: number | undefined;\n    group: number | undefined;\n    start: number;\n    end: number;\n  }\n}\n"]}